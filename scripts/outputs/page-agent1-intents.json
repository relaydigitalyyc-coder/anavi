{
  "upgraded_tsx": "import { useState } from \"react\";\nimport { trpc } from \"@/lib/trpc\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { \n  Target, Plus, Search, Zap, Eye, EyeOff, \n  DollarSign, Clock, Sparkles, Play, Pause, TrendingUp, Filter, ChevronRight, ArrowUpRight\n} from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { TOUR } from \"@/lib/copy\"; // Import TOUR\nimport { FadeInView, StaggerContainer, StaggerItem } from \"@/components/PageTransition\"; // Import PageTransition components\n\nexport default function Intents() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [isAddDialogOpen, setIsAddDialogOpen] = useState(false);\n  const [newIntent, setNewIntent] = useState({\n    intentType: \"buy\" as \"buy\" | \"sell\" | \"invest\" | \"seek_investment\" | \"partner\",\n    title: \"\",\n    description: \"\",\n    assetType: undefined as any,\n    minValue: \"\",\n    maxValue: \"\",\n    targetTimeline: \"\",\n    isAnonymous: true,\n  });\n\n  const { data: intents, isLoading, refetch } = trpc.intent.list.useQuery();\n  const createMutation = trpc.intent.create.useMutation({\n    onSuccess: () => {\n      toast.success(\"Intent created! AI matching is now active.\");\n      setIsAddDialogOpen(false);\n      setNewIntent({\n        intentType: \"buy\",\n        title: \"\",\n        description: \"\",\n        assetType: undefined,\n        minValue: \"\",\n        maxValue: \"\",\n        targetTimeline: \"\",\n        isAnonymous: true,\n      });\n      refetch();\n    },\n    onError: (error) => {\n      toast.error(error.message);\n    },\n  });\n\n  const updateMutation = trpc.intent.update.useMutation({\n    onSuccess: () => {\n      toast.success(\"Intent updated\");\n      refetch();\n    },\n  });\n\n  const findMatchesMutation = trpc.intent.findMatches.useMutation({\n    onSuccess: (data) => {\n      if (data.matches.length > 0) {\n        toast.success(`Found ${data.matches.length} potential matches!`);\n      } else {\n        toast.info(\"No matches found yet. Keep your intent active.\");\n      }\n    },\n    onError: (error) => {\n      toast.error(error.message);\n    },\n  });\n\n  const filteredIntents = intents?.filter(intent => \n    intent.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    intent.description?.toLowerCase().includes(searchQuery.toLowerCase())\n  ) || [];\n\n  const getIntentTypeStyle = (type: string) => {\n    switch (type) {\n      case \"buy\": return \"bg-sky-500\";\n      case \"sell\": return \"bg-rose-500\";\n      case \"invest\": return \"bg-blue-500\";\n      case \"seek_investment\": return \"bg-purple-500\";\n      case \"partner\": return \"bg-sky-500\";\n      default: return \"bg-muted\";\n    }\n  };\n\n  const getStatusBadgeVariant = (status: string) => {\n    switch (status) {\n      case \"matched\": return \"default\";\n      default: return \"outline\";\n    }\n  };\n\n  const stats = [\n    { label: \"Total Intents\", value: intents?.length || 0, icon: Target, color: \"accent\" },\n    { label: \"Active\", value: intents?.filter(i => i.status === 'active').length || 0, icon: Zap, color: \"dark\" },\n    { label: \"Matched\", value: intents?.filter(i => i.status === 'matched').length || 0, icon: TrendingUp, color: \"accent\" },\n    { label: \"Anonymous\", value: intents?.filter(i => i.isAnonymous).length || 0, icon: EyeOff, color: \"dark\" },\n  ];\n\n  return (\n    <FadeInView>\n      <div className=\"min-h-screen bg-background bg-geometric\">\n        {/* Header */}\n        <div className=\"px-8 pt-10 pb-8\">\n          <StaggerContainer>\n            <div className=\"flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6\">\n              <StaggerItem>\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"geo-dot\" />\n                  <span className=\"text-[0.6875rem] font-semibold uppercase tracking-widest text-muted-foreground\">AI Blind Matching</span>\n                </div>\n                <h1 className=\"text-4xl font-semibold tracking-tight text-foreground mb-3\">\n                  Deal <span className=\"gradient-text\">Intents</span>\n                </h1>\n                <p className=\"text-lg text-muted-foreground max-w-md mb-2\">\n                  <span className=\"font-semibold text-foreground\">{TOUR.blindMatch.title}:</span> {TOUR.blindMatch.body}\n                </p>\n              </StaggerItem>\n              \n              <Dialog open={isAddDialogOpen} onOpenChange={setIsAddDialogOpen}>\n                <DialogTrigger asChild>\n                  <StaggerItem delay={0.1}>\n                    <Button className=\"btn-gold flex items-center gap-2\">\n                      <Plus className=\"w-4 h-4\" />\n                      New Intent\n                    </Button>\n                  </StaggerItem>\n                </DialogTrigger>\n                <DialogContent className=\"sm:max-w-lg\">\n                  <DialogHeader>\n                    <DialogTitle className=\"text-2xl font-semibold tracking-tight\">Create Intent</DialogTitle>\n                    <DialogDescription>\n                      AI will match you with compatible counterparties\n                    </DialogDescription>\n                  </DialogHeader>\n                  <div className=\"space-y-4 py-4 max-h-[60vh] overflow-y-auto\">\n                    <div className=\"space-y-2\">\n                      <Label>Intent Type</Label>\n                      <Select\n                        value={newIntent.intentType}\n                        onValueChange={(value: any) => setNewIntent({ ...newIntent, intentType: value })}\n                      >\n                        <SelectTrigger className=\"h-11\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"buy\">Buy / Acquire</SelectItem>\n                          <SelectItem value=\"sell\">Sell / Divest</SelectItem>\n                          <SelectItem value=\"invest\">Invest Capital</SelectItem>\n                          <SelectItem value=\"seek_investment\">Seek Investment</SelectItem>\n                          <SelectItem value=\"partner\">Find Partner</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                      <Label>Title</Label>\n                      <Input\n                        placeholder=\"e.g., Seeking 50,000 MT EN590 Rotterdam delivery\"\n                        value={newIntent.title}\n                        onChange={(e) => setNewIntent({ ...newIntent, title: e.target.value })}\n                        className=\"h-11\"\n                      />\n                    </div>\n\n                    <div className=\"space-y-2\">\n                      <Label>Description</Label>\n                      <Textarea\n                        placeholder=\"Provide details about your requirements...\"\n                        value={newIntent.description}\n                        onChange={(e) => setNewIntent({ ...newIntent, description: e.target.value })}\n                        rows={3}\n                      />\n                    </div>\n\n                    <div className=\"space-y-2\">\n                      <Label>Asset Type</Label>\n                      <Select\n                        value={newIntent.assetType}\n                        onValueChange={(value: any) => setNewIntent({ ...newIntent, assetType: value })}\n                      >\n                        <SelectTrigger className=\"h-11\">\n                          <SelectValue placeholder=\"Select asset type\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"commodity\">Commodity</SelectItem>\n                          <SelectItem value=\"real_estate\">Real Estate</SelectItem>\n                          <SelectItem value=\"equity\">Equity</SelectItem>\n                          <SelectItem value=\"debt\">Debt</SelectItem>\n                          <SelectItem value=\"infrastructure\">Infrastructure</SelectItem>\n                          <SelectItem value=\"renewable_energy\">Renewable Energy</SelectItem>\n                          <SelectItem value=\"mining\">Mining</SelectItem>\n                          <SelectItem value=\"oil_gas\">Oil & Gas</SelectItem>\n                          <SelectItem value=\"business\">Business</SelectItem>\n                          <SelectItem value=\"other\">Other</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label>Min Value (USD)</Label>\n                        <Input\n                          type=\"number\"\n                          placeholder=\"1,000,000\"\n                          value={newIntent.minValue}\n                          onChange={(e) => setNewIntent({ ...newIntent, minValue: e.target.value })}\n                          className=\"h-11\"\n                        />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label>Max Value (USD)</Label>\n                        <Input\n                          type=\"number\"\n                          placeholder=\"10,000,000\"\n                          value={newIntent.maxValue}\n                          onChange={(e) => setNewIntent({ ...newIntent, maxValue: e.target.value })}\n                          className=\"h-11\"\n                        />\n                      </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                      <Label>Target Timeline</Label>\n                      <Input\n                        placeholder=\"e.g., Q2 2026, Within 6 months\"\n                        value={newIntent.targetTimeline}\n                        onChange={(e) => setNewIntent({ ...newIntent, targetTimeline: e.target.value })}\n                        className=\"h-11\"\n                      />\n                    </div>\n\n                    <div className=\"flex items-center justify-between p-4 rounded-xl bg-muted/30 border border-border\">\n                      <div className=\"flex items-center gap-3\">\n                        {newIntent.isAnonymous ? <EyeOff className=\"w-5 h-5 text-accent\" /> : <Eye className=\"w-5 h-5 text-muted-foreground\" />}\n                        <div>\n                          <span className=\"font-medium text-sm\">Anonymous Mode</span>\n                          <p className=\"text-xs text-muted-foreground\">Identity sealed until mutual consent is established.</p>\n                        </div>\n                      </div>\n                      <Switch\n                        checked={newIntent.isAnonymous}\n                        onCheckedChange={(checked) => setNewIntent({ ...newIntent, isAnonymous: checked })}\n                      />\n                    </div>\n\n                    <Button\n                      className=\"btn-gold w-full\"\n                      onClick={() => {\n                        if (!newIntent.title) {\n                          toast.error(\"Please enter a title\");\n                          return;\n                        }\n                        createMutation.mutate({\n                          ...newIntent,\n                          minValue: newIntent.minValue || undefined,\n                          maxValue: newIntent.maxValue || undefined,\n                        });\n                      }}\n                      disabled={createMutation.isPending}\n                    >\n                      {createMutation.isPending ? (\n                        <>\n                          <Sparkles className=\"w-4 h-4 mr-2 animate-spin\" />\n                          Creating...\n                        </>\n                      ) : (\n                        <>\n                          <Zap className=\"w-4 h-4 mr-2\" />\n                          Create Intent\n                        </>\n                      )}\n                    </Button>\n                  </div>\n                </DialogContent>\n              </Dialog>\n            </div>\n          </StaggerContainer>\n        </div>\n\n        {/* Search */}\n        <div className=\"px-8 pb-6\">\n          <StaggerItem delay={0.2}>\n            <div className=\"flex flex-col sm:flex-row gap-4\">\n              <div className=\"relative flex-1 max-w-md\">\n                <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n                <Input\n                  placeholder=\"Search intents...\"\n                  className=\"pl-11 h-12 rounded-xl\"\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                />\n              </div>\n              <Button variant=\"outline\" className=\"flex items-center gap-2\">\n                <Filter className=\"w-4 h-4\" />\n                Filters\n              </Button>\n            </div>\n          </StaggerItem>\n        </div>\n\n        {/* Stats */}\n        <div className=\"px-8 pb-8\">\n          <StaggerItem delay={0.3}>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6\">\n              {stats.map((stat, index) => (\n                <div key={index} className=\"card-elevated p-6\">\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <div className={`w-11 h-11 rounded-xl flex items-center justify-center ${\n                      stat.color === 'accent' ? 'icon-container-accent' : 'icon-container-dark'\n                    }`}>\n                      <stat.icon className={`w-5 h-5 ${\n                        stat.color === 'accent' ? 'text-accent' : 'text-primary-foreground'\n                      }`} />\n                    </div>\n                  </div>\n                  <div className=\"font-data-hud text-number-lg text-foreground mb-1\">{stat.value}</div>\n                  <div className=\"text-xs text-muted-foreground\">{stat.label}</div>\n                </div>\n              ))}\n            </div>\n          </StaggerItem>\n        </div>\n\n        {/* Intents List */}\n        <div className=\"px-8 pb-12\">\n          {isLoading ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {[1, 2, 3, 4].map((i) => (\n                <div key={i} className=\"card-elevated p-6\">\n                  <div className=\"h-40 animate-shimmer rounded-xl\" />\n                </div>\n              ))}\n            </div>\n          ) : filteredIntents.length === 0 ? (\n            <StaggerItem delay={0.4}>\n              <div className=\"card-elevated p-16 text-center\">\n                <div className=\"w-20 h-20 rounded-2xl icon-container mx-auto mb-6 flex items-center justify-center\">\n                  <Target className=\"w-10 h-10 text-muted-foreground\" />\n                </div>\n                <h3 className=\"text-2xl font-semibold tracking-tight text-foreground mb-2\">No Intents Yet</h3>\n                <p className=\"text-muted-foreground mb-6 max-w-sm mx-auto\">\n                  Create your first intent and let AI find compatible counterparties\n                </p>\n                <Button className=\"btn-gold\" onClick={() => setIsAddDialogOpen(true)}>\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Create First Intent\n                </Button>\n              </div>\n            </StaggerItem>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {filteredIntents.map((intent, index) => (\n                <StaggerItem key={intent.id} delay={0.05 * index}>\n                  <div \n                    className=\"card-elevated p-6 hover-lift cursor-pointer group\"\n                  >\n                    <div className=\"flex items-start justify-between mb-4\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className={`w-12 h-12 rounded-xl ${getIntentTypeStyle(intent.intentType)} flex items-center justify-center`}>\n                          <Target className=\"w-6 h-6 text-white\" />\n                        </div>\n                        <div className=\"flex flex-col gap-1\">\n                          <Badge className=\"rounded-full bg-[#0A1628] px-3 py-1 text-xs font-semibold text-white w-fit mb-1\">\n                            Blind Intent\n                          </Badge>\n                          <Badge variant={getStatusBadgeVariant(intent.status || \"draft\")} className=\"text-xs w-fit\">\n                            {(intent.status || 'draft').charAt(0).toUpperCase() + (intent.status || 'draft').slice(1)}\n                          </Badge>\n                          <span className=\"text-xs text-muted-foreground capitalize\">\n                            {intent.intentType.replace('_', ' ')}\n                          </span>\n                        </div>\n                      </div>\n                      {intent.isAnonymous && (\n                        <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n                          <EyeOff className=\"w-3 h-3\" />\n                          Anonymous\n                        </div>\n                      )}\n                    </div>\n\n                    <h3 className=\"text-lg font-semibold text-foreground mb-2 group-hover:text-accent transition-colors line-clamp-1\">\n                      {intent.title}\n                    </h3>\n                    \n                    {intent.description && (\n                      <p className=\"text-sm text-muted-foreground mb-4 line-clamp-2\">\n                        {intent.description}\n                      </p>\n                    )}\n\n                    <div className=\"flex flex-wrap gap-4 text-sm mb-4\">\n                      {(intent.minValue || intent.maxValue) && (\n                        <div className=\"flex items-center gap-1.5 text-muted-foreground\">\n                          <DollarSign className=\"w-4 h-4\" />\n                          <span className=\"font-data-hud\">\n                            ${(parseFloat(intent.minValue || \"0\") / 1000000).toFixed(1)}M - ${(parseFloat(intent.maxValue || \"0\") / 1000000).toFixed(1)}M\n                          </span>\n                        </div>\n                      )}\n                      {intent.assetType && (\n                        <Badge variant=\"outline\" className=\"text-xs capitalize\">\n                          {intent.assetType.replace('_', ' ')}\n                        </Badge>\n                      )}\n                    </div>\n\n                    <div className=\"flex items-center justify-between pt-4 border-t border-border\">\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"flex items-center gap-1.5 text-xs text-muted-foreground\">\n                          <Clock className=\"w-3.5 h-3.5\" />\n                          <span>{new Date(intent.createdAt).toLocaleDateString()}</span>\n                        </div>\n\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"text-xs p-2\"\n                          onClick={() => {\n                            updateMutation.mutate({\n                              id: intent.id,\n                              status: intent.status === 'active' ? 'paused' : 'active'\n                            });\n                          }}\n                        >\n                          {intent.status === 'active' ? <Pause className=\"w-4 h-4\" /> : <Play className=\"w-4 h-4\" />}\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"text-xs p-2\"\n                          onClick={() => findMatchesMutation.mutate({ intentId: intent.id })}\n                        >\n                          <Sparkles className=\"w-4 h-4\" />\n                        </Button>\n                        <Button variant=\"ghost\" size=\"icon\" className=\"text-xs flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                          <ArrowUpRight className=\"w-3.5 h-3.5\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </StaggerItem>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </FadeInView>\n  );\n}",
  "changes_summary": [
    "Added 'Blind Intent' badge to each intent card with ANAVI navy background (`#0A1628`) and white text, styled as a small rounded-full badge.",
    "Imported `TOUR` from `@/lib/copy` and integrated `TOUR.blindMatch.title` and `TOUR.blindMatch.body` as a descriptive subtitle under the main page heading.",
    "Updated the anonymous toggle description in the 'Create Intent' dialog from 'Hide identity until mutual interest' to 'Identity sealed until mutual consent is established.'",
    "Applied the `btn-gold` class to primary call-to-action buttons: 'New Intent', 'Create Intent' (in dialog), and 'Create First Intent' (empty state).",
    "Replaced the generic card styling (`rounded-lg border border-border/60 bg-card p-6 shadow-sm`) with the whitepaper-specified `card-elevated p-6` for all intent cards, stat cards, and the empty state card.",
    "Applied the `font-data-hud` class to display stat values and monetary value ranges (`minValue` / `maxValue`) on intent cards, aligning with the ANAVI visual language for numbers.",
    "Replaced existing `animate-fade-in` and `stagger-X` utility classes with `FadeInView`, `StaggerContainer`, and `StaggerItem` components from `@/components/PageTransition` to implement whitepaper-aligned animation patterns.",
    "Corrected a typo in the search input's `onChange` handler, changing `setNewIntent` to `setSearchQuery` to ensure proper search functionality."
  ],
  "whitepaper_terms_added": [
    "Blind Intent",
    "Identity sealed until mutual consent is established"
  ],
  "copy_tokens_used": [
    "TOUR.blindMatch.title",
    "TOUR.blindMatch.body"
  ]
}